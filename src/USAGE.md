# 薬局在庫管理使用ガイド

## セットアップ

1. 新しいExcelワークブックを作成するか、既存のものを使用する
2. VBAモジュールをインポートする（Alt+F11、右クリック、ファイルのインポート...）
3. DrugNameConverterモジュールから`InitWorkbook`関数を実行して基本構造をセットアップする
4. ワークブックは必要なワークシートと書式設定で初期化されます

## 主な機能

### 医薬品名比較（Sheet1とSheet2）

1. Sheet1で、セルB4にパッケージタイプが選択されていることを確認する
2. Sheet1の列B（7行目から）に比較する医薬品名を追加する
3. Sheet2の列Bにターゲット医薬品名を追加する
4. ツール > マクロメニューから`RunDrugNameComparison`関数を実行する
5. 結果はSheet1の列Cに表示され、マッチ率は列Dに表示されます

### 棚管理

1. tmp_tanaワークシートが存在し、棚情報が含まれていることを確認する
2. Sheet1のA4セルから始まるセルに医薬品名を追加する
3. ShelfManagerモジュールから`UpdateShelfNumbersWithShelfInfo`関数を実行する
4. 棚情報が更新され、CSVファイルが作成されます

## ヒント

- マッチしきい値はデフォルトで80%に設定されていますが、コードで変更できます
- 医薬品名は基本名、剤形タイプ、強度、メーカー、パッケージなどのコンポーネントに解析されます
- システムは様々なパッケージタイプを処理します：PTP、バラ、SP、分包、小包、調剤用、PTP(患者用)
