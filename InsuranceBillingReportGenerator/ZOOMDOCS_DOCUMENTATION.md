# 保険請求管理システム 機能説明資料

このドキュメントは、保険請求管理システムの新機能について説明するためのZoomDocs資料作成用の基礎資料です。

## 1. まとめシート（シート3）機能

### 概要
まとめシート機能は、詳細シート（シート2）のデータを集計し、社保・国保別に未請求、返戻、減点の件数と金額を一覧表示します。これにより、月次の請求状況を一目で把握することができます。

### 画面構成
まとめシートは以下の3つのセクションで構成されています：
1. **社保セクション**：社会保険関連の未請求、返戻、減点データ
2. **国保セクション**：国民健康保険関連の未請求、返戻、減点データ
3. **総合計セクション**：社保と国保を合わせた全体の集計

各セクションには以下の列があります：
- 種別（未請求/返戻/減点）
- 件数
- 金額
- 合計

### 使用方法
1. メニューバーから「保険請求管理」→「CSVファイルから報告書作成」を選択
2. CSVファイルを処理すると、自動的にまとめシートが作成されます
3. 既存の報告書のまとめシートを更新する場合は、「保険請求管理」→「まとめシート更新」を選択

### 技術的な仕組み
- `SummarySheetFunctions.bas`モジュールが中心となり、まとめシートの作成と更新を行います
- 詳細シートのデータを読み取り、保険種別（社保/国保）と種別（未請求/返戻/減点）でグループ化
- 各グループの件数と金額を集計し、まとめシートに表示
- 書式設定（罫線、数値フォーマット、フォントスタイル）を適用

### 利点
- 月次の請求状況を一目で把握できる
- 社保と国保を分けて集計することで、保険種別ごとの傾向を分析できる
- 未請求、返戻、減点の金額を明確に把握できるため、対策を立てやすくなる

## 2. 半期売掛金繰越額計算機能

### 概要
半期売掛金繰越額計算機能は、半期（上期/下期）ごとの売掛金繰越額を計算し、決算書作成のための資料を生成します。上期（4-9月）または下期（10-3月）の各月のレポートから未請求、返戻、減点の金額を抽出し、半期全体の集計を行います。

### 画面構成
生成されるレポートは以下の構成になっています：
1. **ヘッダー**：対象年度と期間（上期/下期）
2. **月別データ**：各月の未請求、返戻、減点の金額
3. **合計**：半期全体の合計金額

### 使用方法
1. メニューバーから「保険請求管理」→「半期売掛金繰越額計算」を選択
2. 対象年度を入力（例：2025）
3. 対象期間を選択（上期/下期）
4. レポートフォルダを選択
5. 生成されたレポートを確認・保存

### 技術的な仕組み
- `HalfYearCalculationModule.bas`モジュールが中心となり、半期売掛金繰越額の計算を行います
- 指定された年度と期間に基づいて、対象となるレポートファイルを特定
- 各月のレポートから未請求、返戻、減点のデータを抽出
- 月別・種別ごとにデータを集計し、半期全体の合計を計算
- 結果を新しいワークブックに出力し、適切な書式を適用

### 利点
- 決算書作成に必要なデータを自動的に集計できる
- 半期ごとの売掛金繰越額を正確に把握できる
- 複数月のデータを一度に処理できるため、手作業による集計ミスを防止できる
- 過去のデータを簡単に参照できるため、年度比較や傾向分析が容易

## 3. 請求誤差追求報告書機能

### 概要
請求誤差追求報告書機能は、減点・査定データから請求誤差を分析し、原因追求のための報告書を作成します。請求点数と実績点数の差異を明確にし、改善策を検討するための基礎資料となります。

### 画面構成
生成される請求誤差追求報告書は以下の列で構成されています：
1. **No.**：連番
2. **患者名**：対象患者
3. **調剤日**：処方日
4. **医療機関**：処方元医療機関
5. **種別**：減点/査定の区分
6. **保険種別**：社保/国保等
7. **請求点数**：当初請求した点数
8. **実績点数**：実際に認められた点数
9. **差異**：請求点数と実績点数の差
10. **原因**：減点・査定の原因（ユーザーが入力）
11. **対策**：再発防止策（ユーザーが入力）

### 使用方法
1. メニューバーから「保険請求管理」→「請求誤差追求報告書作成」を選択
2. 対象年を入力（例：2025）
3. 対象月を入力（例：4）
4. レポートフォルダを選択
5. 生成された請求誤差追求報告書を確認・編集・保存

### 技術的な仕組み
- `BillingDiscrepancyModule.bas`モジュールが中心となり、請求誤差追求報告書の作成を行います
- 指定された年月のレポートファイルから減点・査定データを抽出
- 請求点数と実績点数を計算し、差異を算出
- 結果を新しいワークブックに出力し、適切な書式を適用
- 原因と対策の列を用意し、ユーザーが入力できるようにする

### 利点
- 減点・査定の原因を体系的に分析できる
- 請求誤差の傾向を把握し、再発防止策を立てやすくなる
- 減点・査定データを一覧で確認できるため、類似事例の対策を共有できる
- 定期的な分析により、請求精度の向上につながる

## 4. メニュー統合

### 概要
メニュー統合機能は、すべての機能を「保険請求管理」メニューにまとめ、ユーザーが簡単にアクセスできるようにします。

### メニュー構成
「保険請求管理」メニューには以下の項目があります：
1. **CSVファイルから報告書作成**：CSVファイルを処理して報告書を作成
2. **テンプレート・保存先設定**：テンプレートファイルと保存先フォルダを設定
3. **まとめシート更新**：既存の報告書のまとめシートを更新
4. **半期売掛金繰越額計算**：半期ごとの売掛金繰越額を計算
5. **請求誤差追求報告書作成**：減点・査定データから請求誤差追求報告書を作成
6. **ヘルプ**：各機能の説明

### 技術的な仕組み
- `MenuIntegrationModule.bas`モジュールが中心となり、メニューの作成と管理を行います
- ワークブックを開いたときに自動的にメニューを作成
- ワークブックを閉じるときにメニューを削除
- 各メニュー項目に対応するサブルーチンを呼び出す

### 利点
- 一貫したユーザーインターフェースを提供
- すべての機能に簡単にアクセスできる
- ヘルプ機能により、操作方法を確認できる
- 新機能の追加が容易

## 5. 使用例とワークフロー

### 月次処理のワークフロー
1. CSVファイルを受け取る
2. 「CSVファイルから報告書作成」機能で報告書を作成
3. まとめシートで月次の請求状況を確認
4. 減点・査定がある場合は「請求誤差追求報告書作成」機能で詳細分析

### 半期決算時のワークフロー
1. 半期末（9月または3月）に「半期売掛金繰越額計算」機能を実行
2. 生成された半期売掛金繰越額計算レポートを確認
3. 決算書作成に必要なデータを抽出

### 請求精度向上のワークフロー
1. 「請求誤差追求報告書作成」機能で月次の請求誤差を分析
2. 原因と対策を記入
3. 定期的に過去の請求誤差追求報告書を参照し、改善状況を確認

## 6. 今後の拡張可能性

### 追加機能の提案
1. **グラフ機能**：月次・年次の推移をグラフで表示
2. **データ分析機能**：減点・査定の傾向分析
3. **自動レポート送信機能**：定期的にレポートをメール送信
4. **バックアップ機能**：データの自動バックアップ

### システム改善の提案
1. **パフォーマンス最適化**：大量データ処理の高速化
2. **ユーザーインターフェース改善**：より直感的な操作性
3. **売掛管理表連携**：外部データベースとの連携
4. **セキュリティ強化**：データ暗号化とアクセス制御
