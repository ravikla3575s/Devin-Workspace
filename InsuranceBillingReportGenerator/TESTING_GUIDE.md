# 保険請求管理システム テスト手順書

このドキュメントでは、保険請求管理システムの新機能をテストするための手順を説明します。

## 1. シート3（まとめシート）機能のテスト

### テスト準備
1. テンプレートと保存先フォルダを設定
2. CSVファイルを含むフォルダを用意（fixf, fmei, henr, zognファイルを含む）

### テスト手順
1. メニューから「CSVファイルから報告書作成」を選択
2. CSVフォルダを選択し、処理を実行
3. 生成されたレポートファイルを開き、以下を確認:
   - 「まとめ」シートが作成されていること
   - 社保セクションに未請求、返戻、減点の件数と金額が表示されていること
   - 国保セクションに未請求、返戻、減点の件数と金額が表示されていること
   - 総合計セクションに全体の合計が正しく計算されていること
   - 各セクションの合計行が正しく計算されていること

### 期待結果
- まとめシートが正しく作成され、詳細シートのデータが適切に集計されている
- 社保/国保の区分が正しく行われている
- 金額の書式設定が適切に行われている

## 2. 半期売掛金繰越額計算機能のテスト

### テスト準備
1. 複数月分のレポートファイルを保存先フォルダに用意（上期：4-9月、下期：10-3月）

### テスト手順
1. メニューから「半期売掛金繰越額計算」を選択
2. 対象年度（例：2025）を入力
3. 対象期間（上期/下期）を選択
4. レポートフォルダを選択
5. 生成された売掛金繰越額計算レポートを確認:
   - 各月のデータが正しく抽出されていること
   - 未請求、返戻、減点の金額が正しく転記されていること
   - 合計行が正しく計算されていること

### 期待結果
- 対象期間のレポートファイルが正しく識別されている
- 各月のデータが正しく抽出されている
- 合計が正しく計算されている
- レポートの書式設定が適切に行われている

## 3. 請求誤差追求報告書機能のテスト

### テスト準備
1. 減点・査定データを含むレポートファイルを保存先フォルダに用意

### テスト手順
1. メニューから「請求誤差追求報告書作成」を選択
2. 対象年（例：2025）を入力
3. 対象月（例：4）を入力
4. レポートフォルダを選択
5. 生成された請求誤差追求報告書を確認:
   - 減点・査定データが正しく抽出されていること
   - 請求点数と実績点数が正しく計算されていること
   - 差異が正しく計算されていること
   - 原因と対策の列が用意されていること

### 期待結果
- 対象月のレポートファイルが正しく識別されている
- 減点・査定データのみが抽出されている
- 請求点数、実績点数、差異が正しく計算されている
- レポートの書式設定が適切に行われている

## 4. メニュー統合のテスト

### テスト手順
1. ワークブックを開き、メニューバーに「保険請求管理」メニューが表示されることを確認
2. 各メニュー項目をクリックし、対応する機能が起動することを確認:
   - CSVファイルから報告書作成
   - テンプレート・保存先設定
   - まとめシート更新
   - 半期売掛金繰越額計算
   - 請求誤差追求報告書作成
   - ヘルプ

### 期待結果
- メニューが正しく表示されている
- 各メニュー項目が対応する機能を正しく呼び出している
- ヘルプが正しく表示されている

## 5. エラー処理のテスト

### テスト手順
1. 各機能で以下のエラーケースをテスト:
   - 必要なファイルが存在しない場合
   - 無効なデータが含まれる場合
   - ユーザーがキャンセルした場合
   - 対象期間のファイルが見つからない場合

### 期待結果
- 適切なエラーメッセージが表示される
- プログラムがクラッシュせず、エラー後も正常に動作する
- ユーザーがキャンセルした場合、処理が適切に中断される
