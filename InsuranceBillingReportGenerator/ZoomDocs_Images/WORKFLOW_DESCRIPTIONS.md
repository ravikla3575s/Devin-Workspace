# 保険請求管理システム ワークフロー説明資料

このドキュメントでは、保険請求管理システムの各機能のワークフローについて説明します。ZoomDocsでの資料作成時に参照してください。

## 1. CSVファイル処理から報告書作成までのワークフロー

```
[開始] → [CSVファイルから報告書作成を選択] → [CSVフォルダを選択] → [CSVファイルの読み込み] 
  → [報告書の作成] → [詳細シートの作成] → [まとめシートの作成] → [ファイルの保存] → [終了]
```

### 処理の流れ
1. ユーザーがメニューから「CSVファイルから報告書作成」を選択
2. CSVファイルが含まれるフォルダを選択するダイアログが表示される
3. システムがCSVファイル（fixf, fmei, henr, zogn）を読み込む
4. 報告書（シート1）が作成される
5. 詳細情報（シート2）が作成される
6. まとめシート（シート3）が自動的に作成される
7. 生成されたレポートが保存先フォルダに保存される

### データの流れ
- **入力**：CSVファイル（fixf, fmei, henr, zogn）
- **処理**：データの抽出、集計、フォーマット
- **出力**：Excelレポートファイル（3シート構成）

## 2. まとめシート更新のワークフロー

```
[開始] → [まとめシート更新を選択] → [まとめシート更新フォームの表示] → [更新ボタンをクリック] 
  → [レポートフォルダの選択/確認] → [レポートファイルの検索] → [各ファイルのまとめシート更新] → [終了]
```

### 処理の流れ
1. ユーザーがメニューから「まとめシート更新」を選択
2. まとめシート更新フォームが表示される
3. ユーザーが「更新」ボタンをクリック
4. レポートフォルダが設定されていない場合は選択ダイアログが表示される
5. システムがフォルダ内のレポートファイル（XLSM）を検索
6. 各レポートファイルのまとめシートを更新または作成
7. 処理完了メッセージが表示される

### データの流れ
- **入力**：既存のレポートファイル（XLSM）
- **処理**：詳細シートからのデータ抽出、集計
- **出力**：更新されたまとめシート（シート3）

## 3. 半期売掛金繰越額計算のワークフロー

```
[開始] → [半期売掛金繰越額計算を選択] → [対象年度の入力] → [対象期間の選択（上期/下期）] 
  → [レポートフォルダの選択] → [対象期間のレポートファイル収集] → [データの抽出・集計] 
  → [半期売掛金繰越額計算レポートの作成] → [ファイルの保存] → [終了]
```

### 処理の流れ
1. ユーザーがメニューから「半期売掛金繰越額計算」を選択
2. 対象年度を入力するダイアログが表示される
3. 対象期間（上期/下期）を選択するダイアログが表示される
4. レポートフォルダを選択するダイアログが表示される
5. システムが対象期間のレポートファイルを収集
   - 上期：4月〜9月
   - 下期：10月〜3月
6. 各月のレポートから未請求、返戻、減点のデータを抽出
7. 月別・種別ごとにデータを集計
8. 半期売掛金繰越額計算レポートを作成
9. 生成されたレポートが保存先フォルダに保存される

### データの流れ
- **入力**：複数月のレポートファイル（XLSM）
- **処理**：データの抽出、月別集計、半期合計計算
- **出力**：半期売掛金繰越額計算レポート（XLSX）

## 4. 請求誤差追求報告書作成のワークフロー

```
[開始] → [請求誤差追求報告書作成を選択] → [対象年の入力] → [対象月の入力] 
  → [レポートフォルダの選択] → [対象月のレポートファイル検索] → [減点・査定データの抽出] 
  → [請求点数と実績点数の計算] → [請求誤差追求報告書の作成] → [ファイルの保存] → [終了]
```

### 処理の流れ
1. ユーザーがメニューから「請求誤差追求報告書作成」を選択
2. 対象年を入力するダイアログが表示される
3. 対象月を入力するダイアログが表示される
4. レポートフォルダを選択するダイアログが表示される
5. システムが対象月のレポートファイルを検索
6. レポートファイルから減点・査定データを抽出
7. 請求点数と実績点数を計算し、差異を算出
8. 請求誤差追求報告書を作成（原因と対策の列は空欄）
9. 生成されたレポートが保存先フォルダに保存される

### データの流れ
- **入力**：対象月のレポートファイル（XLSM）
- **処理**：減点・査定データの抽出、点数計算、差異算出
- **出力**：請求誤差追求報告書（XLSX）

## 5. 全体システムのワークフロー

```
[CSVファイル受領] → [CSVファイルから報告書作成] → [報告書確認] → [まとめシート確認] 
  → [減点・査定あり？] → はい → [請求誤差追求報告書作成] → [原因・対策の入力] → [報告書保存]
                      → いいえ → [報告書保存]
  → [半期末？] → はい → [半期売掛金繰越額計算] → [決算書作成用データ抽出] → [終了]
              → いいえ → [終了]
```

### 月次処理の流れ
1. CSVファイルを受領
2. CSVファイルから報告書を作成
3. 報告書の内容を確認
4. まとめシートで月次の請求状況を確認
5. 減点・査定がある場合は請求誤差追求報告書を作成
6. 原因と対策を入力
7. 報告書を保存

### 半期処理の流れ
1. 半期末（9月または3月）に半期売掛金繰越額計算を実行
2. 生成された半期売掛金繰越額計算レポートを確認
3. 決算書作成に必要なデータを抽出

## 6. データ連携図

```
+----------------+     +----------------+     +----------------+
| CSVファイル    |     | レポートファイル|     | 半期売掛金    |
| (fixf,fmei,    | --> | (シート1:報告書)| --> | 繰越額計算    |
| henr,zogn)     |     | (シート2:詳細) |     | レポート      |
+----------------+     | (シート3:まとめ)|     +----------------+
                       +----------------+
                              |
                              v
                       +----------------+
                       | 請求誤差追求  |
                       | 報告書        |
                       +----------------+
```

### データ連携の説明
1. CSVファイルからレポートファイルを作成
   - シート1：報告書（メイン情報）
   - シート2：詳細情報
   - シート3：まとめ（集計情報）

2. レポートファイルから半期売掛金繰越額計算レポートを作成
   - 複数月のレポートファイルのデータを集計
   - 半期全体の合計を計算

3. レポートファイルから請求誤差追求報告書を作成
   - 詳細シートの減点・査定データを抽出
   - 請求点数と実績点数の差異を計算

## 7. ユーザーインタラクション図

```
+----------------+     +----------------+     +----------------+
| メニュー選択   | --> | パラメータ入力 | --> | 処理実行      |
+----------------+     +----------------+     +----------------+
        ^                                            |
        |                                            v
+----------------+     +----------------+     +----------------+
| 次の操作選択   | <-- | 結果確認      | <-- | 結果表示      |
+----------------+     +----------------+     +----------------+
```

### ユーザーインタラクションの説明
1. ユーザーがメニューから機能を選択
2. 必要なパラメータ（年度、期間、月など）を入力
3. システムが処理を実行
4. 結果が表示される
5. ユーザーが結果を確認
6. 次の操作を選択
